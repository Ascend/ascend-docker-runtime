component: installhelper
product: ToolBox
systemEnv:
  - workspace
  - processor
compile:
  name: installhelper
  version:
  input:
    files:
      exclude:
        - remove: [ "{{ systemEnv.workspace }}/ascend-docker-plugin/build/helper/build" ]
      include:
        - commands:
            - command: "mkdir -p {{ systemEnv.workspace }}/ascend-docker-plugin/build/helper/build"
            - command: "cd {{ systemEnv.workspace }}/ascend-docker-plugin/install/deb/src"
            - command: "export GOPATH={{ systemEnv.workspace }}/ascend-docker-plugin/opensource && env"
  process:
    language: go
    compilePath: "{{ systemEnv.workspace }}/ascend-docker-plugin/install/deb/src"
    parameters: [
      [ "buildmode", "pie" ],
      [ "ldflags", '-linkmode=external -buildid=IdNetCheck -extldflags "-Wl,-z,now" -w -s'],
      [ "o", "{{ systemEnv.workspace }}/ascend-docker-plugin/build/helper/build/ascend-docker-plugin-install-helper"],
      [ "trimpath", "{{ systemEnv.workspace }}/ascend-docker-plugin/install/deb/src/main.go"],
      ]
  output:
    files:
      include:
        - copy:
            src: [ "{{ systemEnv.workspace }}/ascend-docker-plugin/install/deb/src/main" ]
            des: "{{ systemEnv.workspace }}/ascend-docker-plugin/build/helper/build/ascend-docker-plugin-install-helper"
            rename: true